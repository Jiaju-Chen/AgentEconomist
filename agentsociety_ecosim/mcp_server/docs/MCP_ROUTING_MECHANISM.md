# MCPå·¥å…·è·¯ç”±æœºåˆ¶è¯¦è§£

## 1. å·¥å…·æ³¨å†Œæœºåˆ¶

### FastMCPè£…é¥°å™¨æ¨¡å¼

æ‰€æœ‰å·¥å…·éƒ½é€šè¿‡ `@mcp.tool()` è£…é¥°å™¨è‡ªåŠ¨æ³¨å†Œï¼š

```python
# åˆ›å»ºMCPå®ä¾‹ï¼ˆå…¨å±€å•ä¾‹ï¼‰
mcp = FastMCP("ai-economist-parameter-server")

# ä½¿ç”¨è£…é¥°å™¨æ³¨å†Œå·¥å…·
@mcp.tool()
async def get_parameter(parameter_name: str) -> str:
    """è·å–å•ä¸ªå‚æ•°çš„è¯¦ç»†ä¿¡æ¯"""
    result = param_manager.get_parameter(parameter_name)
    return json.dumps(result, indent=2, ensure_ascii=False)
```

**å…³é”®ç‚¹**:
- **å·¥å…·åç§°** = **å‡½æ•°åç§°** (`get_parameter`)
- FastMCPä¼šè‡ªåŠ¨å°†å‡½æ•°æ³¨å†Œåˆ°å†…éƒ¨å·¥å…·å­—å…¸
- å·¥å…·å­—å…¸çš„ç»“æ„: `{tool_name: function_reference}`

### å·¥å…·æ³¨å†Œçš„æ—¶æœº

å·¥å…·åœ¨**æœåŠ¡å™¨å¯åŠ¨æ—¶**æ³¨å†Œï¼ˆPythonæ¨¡å—åŠ è½½æ—¶ï¼‰ï¼š
1. æœåŠ¡å™¨å¯åŠ¨ â†’ åŠ è½½ `server_fastmcp.py`
2. Pythonè§£é‡Šå™¨æ‰§è¡Œæ‰€æœ‰ `@mcp.tool()` è£…é¥°å™¨
3. è£…é¥°å™¨å°†å‡½æ•°æ³¨å†Œåˆ° `mcp` å®ä¾‹çš„å†…éƒ¨å­—å…¸
4. FastMCPç”ŸæˆJSON Schemaï¼ˆåŸºäºå‡½æ•°ç­¾åå’Œdocstringï¼‰

## 2. Agentå¦‚ä½•å‘MCPå‘é€æŒ‡ä»¤

### MCPåè®®æ¶ˆæ¯æ ¼å¼

Agenté€šè¿‡**JSON-RPC 2.0**åè®®ä¸MCPæœåŠ¡å™¨é€šä¿¡ï¼š

#### è·å–å·¥å…·åˆ—è¡¨

**è¯·æ±‚**:
```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/list"
}
```

**å“åº”**:
```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "tools": [
      {
        "name": "get_parameter",
        "description": "è·å–å•ä¸ªå‚æ•°çš„è¯¦ç»†ä¿¡æ¯",
        "inputSchema": {
          "type": "object",
          "properties": {
            "parameter_name": {
              "type": "string",
              "description": "å‚æ•°åç§°ï¼Œä¾‹å¦‚ 'income_tax_rate'"
            }
          },
          "required": ["parameter_name"]
        }
      },
      // ... æ›´å¤šå·¥å…·
    ]
  }
}
```

#### è°ƒç”¨å·¥å…·

**è¯·æ±‚**:
```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "method": "tools/call",
  "params": {
    "name": "get_parameter",
    "arguments": {
      "parameter_name": "income_tax_rate"
    }
  }
}
```

**å“åº”**:
```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "result": {
    "content": [
      {
        "type": "text",
        "text": "{\"name\": \"income_tax_rate\", \"value\": 0.45, ...}"
      }
    ]
  }
}
```

### Agentçš„å·¥ä½œæµç¨‹

1. **åˆå§‹åŒ–è¿æ¥**: Agentè¿æ¥åˆ°MCPæœåŠ¡å™¨ï¼ˆé€šè¿‡STDIO/SSE/HTTPï¼‰
2. **è·å–å·¥å…·åˆ—è¡¨**: è°ƒç”¨ `tools/list` è·å–æ‰€æœ‰å¯ç”¨å·¥å…·
3. **åˆ†æç”¨æˆ·éœ€æ±‚**: LLMåˆ†æç”¨æˆ·çš„é—®é¢˜/æŒ‡ä»¤
4. **é€‰æ‹©å·¥å…·**: ä»å·¥å…·åˆ—è¡¨ä¸­é€‰æ‹©åˆé€‚çš„å·¥å…·
5. **æ„å»ºå‚æ•°**: æ ¹æ®å·¥å…·schemaå’Œç”¨æˆ·è¾“å…¥æ„å»ºå‚æ•°
6. **è°ƒç”¨å·¥å…·**: å‘é€ `tools/call` è¯·æ±‚
7. **å¤„ç†ç»“æœ**: æ¥æ”¶å“åº”å¹¶ç»§ç»­å¤„ç†

## 3. MCPå¦‚ä½•è·¯ç”±å·¥å…·è°ƒç”¨

### FastMCPå†…éƒ¨è·¯ç”±æœºåˆ¶

FastMCPä½¿ç”¨**å­—å…¸æŸ¥æ‰¾**çš„æ–¹å¼è·¯ç”±å·¥å…·è°ƒç”¨ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agentå‘é€è¯·æ±‚: tools/call                      â”‚
â”‚  {                                             â”‚
â”‚    "name": "get_parameter",                     â”‚
â”‚    "arguments": {"parameter_name": "..."}      â”‚
â”‚  }                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastMCPæ¥æ”¶è¯·æ±‚                                â”‚
â”‚  1. è§£æJSON-RPCæ¶ˆæ¯                            â”‚
â”‚  2. æå– method: "tools/call"                   â”‚
â”‚  3. æå– params.name: "get_parameter"           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·¥å…·å­—å…¸æŸ¥æ‰¾                                   â”‚
â”‚  tools_dict = {                                 â”‚
â”‚    "get_parameter": <function get_parameter>,   â”‚
â”‚    "set_parameter": <function set_parameter>,   â”‚
â”‚    ...                                          â”‚
â”‚  }                                             â”‚
â”‚                                                  â”‚
â”‚  tool_func = tools_dict["get_parameter"]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‚æ•°è§£æå’ŒéªŒè¯                                 â”‚
â”‚  1. ä» arguments æå–å‚æ•°                        â”‚
â”‚  2. æ ¹æ®å‡½æ•°ç­¾åéªŒè¯å‚æ•°ç±»å‹                     â”‚
â”‚  3. æ£€æŸ¥å¿…éœ€å‚æ•°                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è°ƒç”¨å‡½æ•°                                       â”‚
â”‚  result = await tool_func(                      â”‚
â”‚    parameter_name="income_tax_rate"             â”‚
â”‚  )                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŒ…è£…å“åº”                                       â”‚
â”‚  {                                             â”‚
â”‚    "jsonrpc": "2.0",                           â”‚
â”‚    "id": 2,                                    â”‚
â”‚    "result": {                                 â”‚
â”‚      "content": [{"type": "text", "text": ...}]â”‚
â”‚    }                                           â”‚
â”‚  }                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿”å›ç»™Agent                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è·¯ç”±å…³é”®ä»£ç ï¼ˆæ¦‚å¿µï¼‰

è™½ç„¶FastMCPæ˜¯é—­æºçš„ï¼Œä½†å…¶å·¥ä½œåŸç†ç±»ä¼¼ï¼š

```python
# FastMCPå†…éƒ¨å®ç°ï¼ˆæ¦‚å¿µï¼‰
class FastMCP:
    def __init__(self, name: str):
        self.name = name
        self.tools = {}  # å·¥å…·å­—å…¸: {tool_name: function}
    
    def tool(self):
        """è£…é¥°å™¨ï¼šæ³¨å†Œå·¥å…·"""
        def decorator(func):
            # æ³¨å†Œå·¥å…·ï¼ˆå·¥å…·å = å‡½æ•°åï¼‰
            self.tools[func.__name__] = func
            # ç”Ÿæˆschemaï¼ˆä»å‡½æ•°ç­¾åå’Œdocstringï¼‰
            schema = self._generate_schema(func)
            func._mcp_schema = schema
            return func
        return decorator
    
    async def handle_tools_call(self, request):
        """å¤„ç†å·¥å…·è°ƒç”¨è¯·æ±‚"""
        tool_name = request.params["name"]
        arguments = request.params["arguments"]
        
        # æŸ¥æ‰¾å·¥å…·ï¼ˆè·¯ç”±ï¼‰
        if tool_name not in self.tools:
            raise ValueError(f"Tool not found: {tool_name}")
        
        tool_func = self.tools[tool_name]
        
        # è§£æå‚æ•°
        parsed_args = self._parse_arguments(tool_func, arguments)
        
        # è°ƒç”¨å‡½æ•°
        result = await tool_func(**parsed_args)
        
        # è¿”å›ç»“æœ
        return {
            "content": [{"type": "text", "text": result}]
        }
```

## 4. å·¥å…·è°ƒç”¨ç¤ºä¾‹

### å®Œæ•´è°ƒç”¨æµç¨‹ç¤ºä¾‹

```
ç”¨æˆ·é—®é¢˜: "What is the current income tax rate?"

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agentåˆ†æ                                          â”‚
â”‚ 1. éœ€è¦è·å–å‚æ•°ä¿¡æ¯                                â”‚
â”‚ 2. æŸ¥æ‰¾å·¥å…·åˆ—è¡¨ï¼Œæ‰¾åˆ° "get_parameter"              â”‚
â”‚ 3. æ„å»ºå‚æ•°: {"parameter_name": "income_tax_rate"}â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent â†’ MCP Server                                 â”‚
â”‚ POST /mcp                                          â”‚
â”‚ {                                                  â”‚
â”‚   "jsonrpc": "2.0",                               â”‚
â”‚   "id": 1,                                        â”‚
â”‚   "method": "tools/call",                         â”‚
â”‚   "params": {                                     â”‚
â”‚     "name": "get_parameter",                      â”‚
â”‚     "arguments": {                                â”‚
â”‚       "parameter_name": "income_tax_rate"         â”‚
â”‚     }                                             â”‚
â”‚   }                                               â”‚
â”‚ }                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastMCPè·¯ç”±                                        â”‚
â”‚ 1. æå– tool_name = "get_parameter"               â”‚
â”‚ 2. æŸ¥æ‰¾ tools["get_parameter"]                    â”‚
â”‚ 3. æ‰¾åˆ°å‡½æ•°: <function get_parameter>              â”‚
â”‚ 4. è§£æå‚æ•°: {"parameter_name": "income_tax_rate"}â”‚
â”‚ 5. è°ƒç”¨: await get_parameter("income_tax_rate")   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‡½æ•°æ‰§è¡Œ                                           â”‚
â”‚ result = param_manager.get_parameter(              â”‚
â”‚   "income_tax_rate"                               â”‚
â”‚ )                                                 â”‚
â”‚ # è¿”å›: {"name": "income_tax_rate", "value": 0.45}â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MCP Server â†’ Agent                                 â”‚
â”‚ {                                                  â”‚
â”‚   "jsonrpc": "2.0",                               â”‚
â”‚   "id": 1,                                        â”‚
â”‚   "result": {                                     â”‚
â”‚     "content": [                                  â”‚
â”‚       {                                           â”‚
â”‚         "type": "text",                           â”‚
â”‚         "text": "{\"name\": \"income_tax_rate\",  â”‚
â”‚                  \"value\": 0.45, ...}"           â”‚
â”‚       }                                           â”‚
â”‚     ]                                             â”‚
â”‚   }                                               â”‚
â”‚ }                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agentå¤„ç†ç»“æœ                                      â”‚
â”‚ è§£æJSONï¼Œæå– value: 0.45                        â”‚
â”‚ å›ç­”ç”¨æˆ·: "The income tax rate is 0.45 (45%)"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. å·¥å…·é€‰æ‹©æœºåˆ¶

### Agentå¦‚ä½•é€‰æ‹©å·¥å…·

ç°ä»£AI Agentï¼ˆå¦‚Cursorä½¿ç”¨çš„LLMï¼‰ä½¿ç”¨ä»¥ä¸‹æœºåˆ¶é€‰æ‹©å·¥å…·ï¼š

1. **å·¥å…·æè¿°åŒ¹é…**: 
   - LLMé˜…è¯»æ¯ä¸ªå·¥å…·çš„ `description` å’Œ `inputSchema`
   - åŒ¹é…ç”¨æˆ·æ„å›¾å’Œå·¥å…·åŠŸèƒ½

2. **å‚æ•°åŒ¹é…**:
   - LLMæ ¹æ®ç”¨æˆ·è¾“å…¥å’Œå·¥å…·schemaæ„å»ºå‚æ•°
   - å¦‚æœå‚æ•°åŒ¹é…ï¼Œå·¥å…·å¯ç”¨

3. **ä¸Šä¸‹æ–‡ç†è§£**:
   - LLMåˆ†æå¯¹è¯ä¸Šä¸‹æ–‡
   - ç†è§£ç”¨æˆ·æ„å›¾ï¼ˆæŸ¥è¯¢ã€è®¾ç½®ã€åˆ†æç­‰ï¼‰

4. **å·¥å…·é“¾æ„å»º**:
   - LLMå¯èƒ½é€‰æ‹©å¤šä¸ªå·¥å…·ç»„æˆå·¥ä½œæµ
   - ä¾‹å¦‚ï¼šå…ˆ `analyze_question` â†’ å† `generate_config` â†’ å† `set_parameters`

### ç¤ºä¾‹ï¼šAgenté€‰æ‹©å·¥å…·é“¾

```
ç”¨æˆ·: "How will AI agents reshape the labor market?"

Agentæ€è€ƒ:
1. è¿™æ˜¯ä¸€ä¸ªç ”ç©¶é—®é¢˜ï¼Œéœ€è¦åšå®éªŒ
2. éœ€è¦åˆ†æé—®é¢˜ â†’ analyze_question
3. éœ€è¦ç”Ÿæˆé…ç½® â†’ generate_config_from_question  
4. éœ€è¦è®¾ç½®å‚æ•° â†’ batch_set_parameters
5. éœ€è¦å¯åŠ¨å®éªŒ â†’ start_simulation
6. éœ€è¦åˆ†æç»“æœ â†’ analyze_experiment

Agentæ‰§è¡Œ:
â†’ analyze_question("How will AI agents...")
â†’ generate_config_from_question(...)
â†’ batch_set_parameters({...})
â†’ start_simulation()
â†’ analyze_experiment(...)
```

## 6. å®é™…ä»£ç ç»“æ„

### å½“å‰ç³»ç»Ÿçš„å·¥å…·ç»„ç»‡

```python
# server_fastmcp.py

mcp = FastMCP("ai-economist-parameter-server")

# ç›´æ¥æ³¨å†Œçš„å·¥å…·ï¼ˆ10ä¸ªï¼‰
@mcp.tool()
async def get_parameter(...): ...

@mcp.tool()
async def set_parameter(...): ...

# ... æ›´å¤šå·¥å…·

# é€šè¿‡æ¨¡å—æ³¨å†Œçš„å·¥å…·
history_tools.register_tools(mcp)  # æ³¨å†Œ6ä¸ªå†å²åˆ†æå·¥å…·
simulation_tools.register_tools(mcp)  # æ³¨å†Œ7ä¸ªä»¿çœŸå·¥å…·

# åŠ¨æ€æ³¨å†Œçš„å·¥å…·
if ANALYZER_TOOLS_AVAILABLE:
    @mcp.tool()
    async def analyze_experiment(...): ...
```

### register_tools æ–¹æ³•

æŸäº›å·¥å…·æ¨¡å—ä½¿ç”¨ `register_tools()` æ–¹æ³•æ‰¹é‡æ³¨å†Œï¼š

```python
# tools/history_tools.py
def register_tools(mcp):
    @mcp.tool()
    async def list_history_experiments(...): ...
    
    @mcp.tool()
    async def generate_experiment_report(...): ...
    
    # ... æ›´å¤šå·¥å…·
```

è¿™ç§æ–¹å¼å…è®¸ï¼š
- æ¨¡å—åŒ–ç»„ç»‡å·¥å…·
- æ¡ä»¶æ€§æ³¨å†Œï¼ˆå¦‚æœæ¨¡å—å¯ç”¨æ‰æ³¨å†Œï¼‰
- å»¶è¿Ÿæ³¨å†Œï¼ˆåœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶æ³¨å†Œï¼‰

## 7. è°ƒè¯•å’Œç›‘æ§

### æŸ¥çœ‹å·²æ³¨å†Œçš„å·¥å…·

æœåŠ¡å™¨å¯åŠ¨æ—¶ä¼šæ‰“å°æ‰€æœ‰å·¥å…·ï¼š

```bash
python server_fastmcp.py

# è¾“å‡º:
# ğŸ“‹ å‚æ•°ç®¡ç†å·¥å…· (10ä¸ª):
#   1. get_all_parameters
#   2. get_parameter
#   ...
# ğŸ“Š å®éªŒåˆ†æå·¥å…· (5ä¸ª):
#   1. capture_experiment
#   ...
```

### å·¥å…·è°ƒç”¨æ—¥å¿—

å¯ä»¥åœ¨å·¥å…·å‡½æ•°ä¸­æ·»åŠ æ—¥å¿—æ¥ç›‘æ§è°ƒç”¨ï¼š

```python
@mcp.tool()
async def get_parameter(parameter_name: str) -> str:
    print(f"[LOG] get_parameter called with: {parameter_name}")
    result = param_manager.get_parameter(parameter_name)
    print(f"[LOG] get_parameter returning: {result}")
    return json.dumps(result, indent=2, ensure_ascii=False)
```

## æ€»ç»“

1. **å·¥å…·æ³¨å†Œ**: é€šè¿‡ `@mcp.tool()` è£…é¥°å™¨ï¼Œå·¥å…·å = å‡½æ•°å
2. **Agentè°ƒç”¨**: é€šè¿‡JSON-RPCåè®®å‘é€ `tools/call` è¯·æ±‚ï¼ŒåŒ…å«å·¥å…·åå’Œå‚æ•°
3. **è·¯ç”±æœºåˆ¶**: FastMCPä½¿ç”¨å­—å…¸æŸ¥æ‰¾ï¼ˆ`tools[tool_name]`ï¼‰è·¯ç”±åˆ°å¯¹åº”å‡½æ•°
4. **å·¥å…·é€‰æ‹©**: LLMåŸºäºå·¥å…·æè¿°å’Œç”¨æˆ·æ„å›¾é€‰æ‹©åˆé€‚å·¥å…·
5. **å‚æ•°è§£æ**: FastMCPè‡ªåŠ¨è§£æå’ŒéªŒè¯å‚æ•°ï¼ˆåŸºäºå‡½æ•°ç­¾åï¼‰
6. **ç»“æœè¿”å›**: å‡½æ•°è¿”å›å€¼è‡ªåŠ¨åŒ…è£…æˆMCPå“åº”æ ¼å¼è¿”å›ç»™Agent

æ•´ä¸ªæœºåˆ¶æ˜¯**å£°æ˜å¼**çš„ï¼šå¼€å‘è€…åªéœ€å®šä¹‰å‡½æ•°å’Œæ·»åŠ è£…é¥°å™¨ï¼ŒFastMCPå¤„ç†æ‰€æœ‰è·¯ç”±å’Œåè®®ç»†èŠ‚ã€‚

